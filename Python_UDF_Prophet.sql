CREATE OR REPLACE FUNCTION PROPHETIZE_DAILY(ID STRING, X FLOAT, Y DATE, PERIODS NUMBER)
RETURNS TABLE(ID STRING, Y FLOAT, D STRING)
LANGUAGE PYTHON
RUNTIME_VERSION = 3.8
PACKAGES = ('prophet')
HANDLER = 'X'
AS $$
import pandas as pd
from prophet import Prophet

class X:
    def __init__(self):
        self._dates=[]
        self._values=[]
        
    def process(self, id, y, d, periods):
        self._dates.append(d)
        self._values.append(y)
        self._id=id
        self._periods=periods
        return ((id, y, d),)
        
    def end_partition(self):
        df=pd.DataFrame(list(zip(self._dates, self._values)), columns=['ds', 'y'])
        model=Prophet()
        model.fit(df)
        future_df=model.make_future_dataframe(periods=self._periods, include_history=False)
        forecast=model.predict(future_df)
        for row in forecast.itertuples():
            yield(self._id, row.yhat, row.ds)
            yield(self._id + '_lower', row.yhat_lower, row.ds)
            yield(self._id + '_upper', row.yhat_upper, row.ds)
$$;

CREATE OR REPLACE TEMP TABLE TMP
(ORDER_DATE_ID STRING, ORDER_TYPE STRING, ORDERS INTEGER);

INSERT INTO TMP VALUES
('20170101','A',367),
('20170102','B',10272),
('20170102','A',1289),
('20170103','B',8238),
('20170103','A',1367),
('20170104','A',1219),
('20170104','B',7644),
('20170105','B',6164),
('20170105','A',1135),
('20170106','A',440),
('20170107','A',442),
('20170108','A',474),
('20170109','A',1982),
('20170109','B',18164),
('20170110','B',6973),
('20170110','A',1531),
('20170111','A',1402),
('20170111','B',5411),
('20170112','B',5557),
('20170112','A',1338),
('20170113','A',1173),
('20170113','B',6222),
('20170114','A',408),
('20170115','A',479),
('20170116','B',14439),
('20170116','A',1368),
('20170117','B',6497),
('20170117','A',1440),
('20170118','A',1082),
('20170118','B',6154),
('20170119','A',1268),
('20170119','B',4671),
('20170120','A',1224),
('20170120','B',5176),
('20170121','A',314),
('20170122','A',429),
('20170123','B',12666),
('20170123','A',1580),
('20170124','B',6007),
('20170124','A',1686),
('20170125','B',5360),
('20170125','A',1359),
('20170126','B',4694),
('20170126','A',1029),
('20170127','B',4285),
('20170127','A',1161),
('20170128','A',414),
('20170129','A',498),
('20170130','A',1459),
('20170130','B',13284),
('20170131','A',1439),
('20170131','B',7238),
('20170201','B',5792),
('20170201','A',1166),
('20170202','A',933),
('20170202','B',4993),
('20170203','B',4416),
('20170203','A',939),
('20170204','A',430),
('20170205','A',525),
('20170206','A',1021),
('20170206','B',11795),
('20170207','B',5455),
('20170207','A',1343),
('20170208','B',3912),
('20170208','A',1070),
('20170209','B',5422),
('20170209','A',1067),
('20170210','A',949),
('20170210','B',4430),
('20170211','A',376),
('20170212','A',488),
('20170213','A',1313),
('20170213','B',12493),
('20170214','A',1160),
('20170214','B',6570),
('20170215','B',5890),
('20170215','A',1261),
('20170216','B',6434),
('20170216','A',1158),
('20170217','B',6068),
('20170217','A',956),
('20170218','A',393),
('20170219','A',441),
('20170220','B',14953),
('20170220','A',1614),
('20170221','A',1205),
('20170221','B',6817),
('20170222','A',1282),
('20170222','B',5836),
('20170223','B',5224),
('20170223','A',1014),
('20170224','B',5326),
('20170224','A',935),
('20170225','A',337),
('20170226','A',474),
('20170227','A',1233),
('20170227','B',12295),
('20170228','B',7009),
('20170228','A',1524),
('20170301','A',1039),
('20170301','B',5344),
('20170302','B',4521),
('20170302','A',1042),
('20170303','A',1280),
('20170303','B',4423),
('20170304','A',453),
('20170305','A',465),
('20170306','A',1437),
('20170306','B',11264),
('20170307','B',4659),
('20170307','A',1647),
('20170308','B',4540),
('20170308','A',1106),
('20170309','A',1353),
('20170309','B',3866),
('20170310','A',883),
('20170310','B',3789),
('20170311','A',402),
('20170312','A',488),
('20170313','A',1878),
('20170313','B',8901),
('20170314','A',1198),
('20170314','B',4611),
('20170315','A',1128),
('20170315','B',4038),
('20170316','B',3663),
('20170316','A',906),
('20170317','B',3489),
('20170317','A',1084),
('20170318','A',581),
('20170319','A',546),
('20170320','B',10533),
('20170320','A',1759),
('20170321','B',4966),
('20170321','A',1234),
('20170322','A',1326),
('20170322','B',4605),
('20170323','B',4433),
('20170323','A',981),
('20170324','B',3640),
('20170324','A',964),
('20170325','A',371),
('20170326','A',471),
('20170327','A',1311),
('20170327','B',9449),
('20170328','B',4446),
('20170328','A',1315),
('20170329','B',4212),
('20170329','A',1264),
('20170330','A',1251),
('20170330','B',4481),
('20170331','A',876),
('20170331','B',4051),
('20170401','A',400),
('20170402','A',490),
('20170403','B',9745),
('20170403','A',1461),
('20170404','A',1210),
('20170404','B',4669),
('20170405','A',1210),
('20170405','B',4188),
('20170406','A',1011),
('20170406','B',3822),
('20170407','B',3590),
('20170407','A',941),
('20170408','A',337),
('20170409','A',368),
('20170410','A',1658),
('20170410','B',7546),
('20170411','B',3325),
('20170411','A',1290),
('20170412','B',4425),
('20170412','A',1249),
('20170413','A',998),
('20170413','B',3441),
('20170414','A',355),
('20170415','A',306),
('20170416','A',336),
('20170417','A',490),
('20170418','B',15565),
('20170418','A',2058),
('20170419','B',5329),
('20170419','A',1255),
('20170420','A',1297),
('20170420','B',4169),
('20170421','A',1067),
('20170421','B',4238),
('20170422','A',349),
('20170423','A',433),
('20170424','B',10257),
('20170424','A',1583),
('20170425','B',4034),
('20170425','A',1095),
('20170426','B',4317),
('20170426','A',1187),
('20170427','B',3577),
('20170427','A',1172),
('20170428','A',973),
('20170428','B',3731),
('20170429','B',2779),
('20170429','A',379),
('20170430','A',281),
('20170501','A',477),
('20170502','B',9027),
('20170502','A',1705),
('20170503','B',5168),
('20170503','A',1143),
('20170504','A',1287),
('20170504','B',3800),
('20170505','A',934),
('20170505','B',3902),
('20170506','A',311),
('20170507','A',429),
('20170508','A',1703),
('20170508','B',8682),
('20170509','A',1099),
('20170509','B',4341),
('20170510','B',3754),
('20170510','A',1182),
('20170511','A',923),
('20170511','B',3409),
('20170512','A',888),
('20170512','B',2902),
('20170513','A',255),
('20170514','A',334),
('20170515','A',1312),
('20170515','B',6363),
('20170516','A',1376),
('20170516','B',3842),
('20170517','B',3384),
('20170517','A',839),
('20170518','A',766),
('20170518','B',2962),
('20170519','A',938),
('20170519','B',3209),
('20170520','A',363),
('20170521','A',413),
('20170522','A',1550),
('20170522','B',7008),
('20170523','B',3213),
('20170523','A',932),
('20170524','A',1084),
('20170524','B',3260),
('20170525','A',357),
('20170526','A',1133),
('20170526','B',3782),
('20170527','A',306),
('20170528','A',373),
('20170529','A',1524),
('20170529','B',6091),
('20170530','B',3419),
('20170530','A',1073),
('20170531','B',3941),
('20170531','A',1301),
('20170601','A',897),
('20170601','B',3065),
('20170602','B',2616),
('20170602','A',905),
('20170603','A',374),
('20170604','A',328),
('20170605','A',465),
('20170606','A',1585),
('20170606','B',8053),
('20170607','B',3660),
('20170607','A',994),
('20170608','B',3130),
('20170608','A',1145),
('20170609','A',1065),
('20170609','B',2429),
('20170610','A',326),
('20170611','A',361),
('20170612','B',5219),
('20170612','A',1337),
('20170613','B',2793),
('20170613','A',992),
('20170614','B',2790),
('20170614','A',1133),
('20170615','A',272),
('20170616','B',4735),
('20170616','A',1432),
('20170617','A',386),
('20170618','A',413),
('20170619','B',5806),
('20170619','A',1471),
('20170620','B',2924),
('20170620','A',1132),
('20170621','B',3546),
('20170621','A',1360),
('20170622','A',1036),
('20170622','B',2672),
('20170623','B',2806),
('20170623','A',1020),
('20170624','A',385),
('20170625','A',499),
('20170626','B',6913),
('20170626','A',1663),
('20170627','A',1118),
('20170627','B',3406),
('20170628','A',1275),
('20170628','B',3436),
('20170629','A',969),
('20170629','B',2962),
('20170630','B',3313),
('20170630','A',1174),
('20170701','A',436),
('20170702','A',492),
('20170703','B',8513),
('20170703','A',1770),
('20170704','A',1092),
('20170704','B',3917),
('20170705','A',1188),
('20170705','B',3202),
('20170706','B',2596),
('20170706','A',983),
('20170707','A',1174),
('20170707','B',2533),
('20170708','A',459),
('20170709','A',543),
('20170710','B',5668),
('20170710','A',1837),
('20170711','A',1286),
('20170711','B',3317),
('20170712','A',1474),
('20170712','B',3701),
('20170713','A',1103),
('20170713','B',3241),
('20170714','B',2783),
('20170714','A',969),
('20170715','A',416),
('20170716','A',455),
('20170717','B',6758),
('20170717','A',1580),
('20170718','B',2825),
('20170718','A',1089),
('20170719','B',3008),
('20170719','A',1039),
('20170720','A',1002),
('20170720','B',2728),
('20170721','B',2623),
('20170721','A',949),
('20170722','A',432),
('20170723','A',445),
('20170724','B',6551),
('20170724','A',1513),
('20170725','B',3602),
('20170725','A',972),
('20170726','A',1296),
('20170726','B',3898),
('20170727','A',1059),
('20170727','B',3489),
('20170728','A',941),
('20170728','B',2978),
('20170729','A',370),
('20170730','A',411),
('20170731','B',8304),
('20170731','A',1640),
('20170801','B',4044),
('20170801','A',1043),
('20170802','A',1229),
('20170802','B',4474),
('20170803','B',3798),
('20170803','A',1024),
('20170804','A',797),
('20170804','B',3460),
('20170805','A',311),
('20170806','A',367),
('20170807','B',7677),
('20170807','A',1547),
('20170808','A',956),
('20170808','B',4177),
('20170809','B',4510),
('20170809','A',1199),
('20170810','B',3307),
('20170810','A',1142),
('20170811','A',1008),
('20170811','B',3867),
('20170812','A',328),
('20170813','A',514),
('20170814','A',1450),
('20170814','B',8358),
('20170815','B',3586),
('20170815','A',996),
('20170816','B',3642),
('20170816','A',1324),
('20170817','B',3565),
('20170817','A',1039),
('20170818','B',3838),
('20170818','A',1053),
('20170819','A',560),
('20170820','A',669),
('20170821','B',8407),
('20170821','A',1734),
('20170822','A',1101),
('20170822','B',5204),
('20170823','A',1187),
('20170823','B',3621),
('20170824','A',1036),
('20170824','B',3278),
('20170825','B',3538),
('20170825','A',1069),
('20170826','A',462),
('20170827','A',511),
('20170828','A',1468),
('20170828','B',8107),
('20170829','B',4217),
('20170829','A',1625),
('20170830','A',1394),
('20170830','B',3990),
('20170831','A',1301),
('20170831','B',4519),
('20170901','A',1056),
('20170901','B',4290),
('20170902','A',513),
('20170903','A',557),
('20170904','A',1588),
('20170904','B',9402),
('20170905','A',1088),
('20170905','B',4677),
('20170906','B',4202),
('20170906','A',1093),
('20170907','A',1565),
('20170907','B',4023),
('20170908','A',1251),
('20170908','B',3696),
('20170909','A',361),
('20170910','A',359),
('20170911','A',1547),
('20170911','B',9663),
('20170912','A',1048),
('20170912','B',4850),
('20170913','B',4545),
('20170913','A',1243),
('20170914','A',1052),
('20170914','B',4580),
('20170915','B',3756),
('20170915','A',1190),
('20170916','A',280),
('20170917','A',350),
('20170918','A',1378),
('20170918','B',8800),
('20170919','B',5372),
('20170919','A',1071),
('20170920','A',1120),
('20170920','B',4405),
('20170921','B',4525),
('20170921','A',793),
('20170922','A',1147),
('20170922','B',4241),
('20170923','A',350),
('20170924','A',365),
('20170925','A',1660),
('20170925','B',9967),
('20170926','B',5554),
('20170926','A',928),
('20170927','B',5137),
('20170927','A',1243),
('20170928','A',915),
('20170928','B',4716),
('20170929','A',931),
('20170929','B',4490),
('20170930','A',394),
('20170930','B',3436),
('20171001','A',414),
('20171002','B',8001),
('20171002','A',1308),
('20171003','A',452),
('20171004','B',11322),
('20171004','A',1202),
('20171005','A',923),
('20171005','B',7068),
('20171006','A',1042),
('20171006','B',5303),
('20171007','A',350),
('20171008','A',399),
('20171009','B',12472),
('20171009','A',1037),
('20171010','B',6061),
('20171010','A',1093),
('20171011','A',1212),
('20171011','B',5454),
('20171012','A',838),
('20171012','B',4701),
('20171013','B',3797),
('20171013','A',974),
('20171014','A',355),
('20171015','A',346),
('20171016','B',10618),
('20171016','A',1302),
('20171017','A',1139),
('20171017','B',4790),
('20171018','A',1507),
('20171018','B',4917),
('20171019','B',4622),
('20171019','A',1028),
('20171020','B',4490),
('20171020','A',1022),
('20171021','A',438),
('20171022','A',533),
('20171023','B',14142),
('20171023','A',1682),
('20171024','B',7522),
('20171024','A',1127),
('20171025','B',6312),
('20171025','A',1201),
('20171026','B',5930),
('20171026','A',923),
('20171027','A',820),
('20171027','B',5466),
('20171028','A',337),
('20171029','A',433),
('20171030','B',16776),
('20171030','A',1612),
('20171031','A',420),
('20171101','A',427),
('20171102','A',1414),
('20171102','B',21864),
('20171103','A',1238),
('20171103','B',7822),
('20171104','A',376),
('20171105','A',471),
('20171106','B',22937),
('20171106','A',1764),
('20171107','B',8075),
('20171107','A',1125),
('20171108','B',7498),
('20171108','A',1052),
('20171109','A',915),
('20171109','B',6348),
('20171110','B',6246),
('20171110','A',891),
('20171111','A',363),
('20171112','A',469),
('20171113','A',1739),
('20171113','B',20116),
('20171114','B',8163),
('20171114','A',994),
('20171115','B',7871),
('20171115','A',970),
('20171116','B',6938),
('20171116','A',915),
('20171117','B',7698),
('20171117','A',821),
('20171118','A',412),
('20171119','A',482),
('20171120','A',1263),
('20171120','B',22501),
('20171121','A',896),
('20171121','B',9025),
('20171122','B',8725),
('20171122','A',1050),
('20171123','B',6645),
('20171123','A',890),
('20171124','B',6052),
('20171124','A',1103),
('20171125','A',497),
('20171126','A',595),
('20171127','A',1476),
('20171127','B',18431),
('20171128','B',8482),
('20171128','A',961),
('20171129','B',7724),
('20171129','A',1153),
('20171130','A',873),
('20171130','B',7973),
('20171201','B',5965),
('20171201','A',959),
('20171202','A',420),
('20171203','A',569),
('20171204','A',1284),
('20171204','B',14118),
('20171205','B',6676),
('20171205','A',937),
('20171206','B',5357),
('20171206','A',1095),
('20171207','B',5393),
('20171207','A',985),
('20171208','B',5109),
('20171208','A',957),
('20171209','A',432),
('20171210','A',540),
('20171211','B',12970),
('20171211','A',1455),
('20171212','A',1062),
('20171212','B',5864),
('20171213','B',5616),
('20171213','A',1163),
('20171214','B',4788),
('20171214','A',946),
('20171215','A',1030),
('20171215','B',5330),
('20171216','A',495),
('20171217','A',588),
('20171218','A',1568),
('20171218','B',12830),
('20171219','B',5940),
('20171219','A',1082),
('20171220','B',5815),
('20171220','A',1002),
('20171221','A',783),
('20171221','B',4803),
('20171222','A',832),
('20171222','B',4143),
('20171223','A',310),
('20171224','A',196),
('20171225','A',308),
('20171226','A',452),
('20171227','A',1638),
('20171227','B',13566),
('20171228','A',1117),
('20171228','B',6664),
('20171229','A',989),
('20171229','B',7316),
('20171230','A',446),
('20171231','A',727),
('20171231','B',9655),
('20180101','A',370),
('20180102','A',1377),
('20180102','B',9810),
('20180103','A',1062),
('20180103','B',8391),
('20180104','A',1323),
('20180104','B',7114),
('20180105','A',929),
('20180105','B',6017),
('20180106','A',417),
('20180107','A',456),
('20180108','B',15686),
('20180108','A',1306),
('20180109','A',805),
('20180109','B',6543),
('20180110','B',5989),
('20180110','A',1154),
('20180111','A',922),
('20180111','B',5119),
('20180112','A',1018),
('20180112','B',5130),
('20180113','A',459),
('20180114','A',490),
('20180115','B',14925),
('20180115','A',1745),
('20180116','B',6014),
('20180116','A',948),
('20180117','A',1207),
('20180117','B',5761),
('20180118','A',913),
('20180118','B',4980),
('20180119','A',937),
('20180119','B',3777),
('20180120','A',367),
('20180121','A',467),
('20180122','B',11779),
('20180122','A',1516),
('20180123','B',5409),
('20180123','A',1073),
('20180124','B',4417),
('20180124','A',1064),
('20180125','B',4079),
('20180125','A',817),
('20180126','A',882),
('20180126','B',4157),
('20180127','A',429),
('20180128','A',473),
('20180129','A',1345),
('20180129','B',12138),
('20180130','A',1156),
('20180130','B',5493),
('20180131','A',1359),
('20180131','B',5484),
('20180201','A',925),
('20180201','B',3685),
('20180202','A',749),
('20180202','B',4590),
('20180203','A',388),
('20180204','A',416),
('20180205','A',1198),
('20180205','B',10437),
('20180206','A',928),
('20180206','B',5011),
('20180207','B',5596),
('20180207','A',909),
('20180208','A',1042),
('20180208','B',4331),
('20180209','A',808),
('20180209','B',4027),
('20180210','A',370),
('20180211','A',450),
('20180212','B',17929),
('20180212','A',1057),
('20180213','A',1079),
('20180213','B',5124),
('20180214','B',6066),
('20180214','A',926),
('20180215','B',4891),
('20180215','A',906),
('20180216','B',5478),
('20180216','A',747),
('20180217','A',456),
('20180218','A',528),
('20180219','B',19670),
('20180219','A',1308),
('20180220','A',902),
('20180220','B',7330),
('20180221','A',937),
('20180221','B',6130),
('20180222','B',3989),
('20180222','A',894),
('20180223','B',3584),
('20180223','A',729),
('20180224','A',377),
('20180225','A',749),
('20180226','B',11378),
('20180226','A',1516),
('20180227','A',1200),
('20180227','B',4918),
('20180228','A',1032),
('20180228','B',5217),
('20180301','A',1034),
('20180301','B',4439),
('20180302','B',4311),
('20180302','A',997),
('20180303','A',372),
('20180304','A',507),
('20180305','A',1517),
('20180305','B',11021),
('20180306','A',1058),
('20180306','B',4491),
('20180307','B',3940),
('20180307','A',1233),
('20180308','A',982),
('20180308','B',3757),
('20180309','A',661),
('20180309','B',3388),
('20180310','A',347),
('20180311','A',448),
('20180312','B',10055),
('20180312','A',1453),
('20180313','A',1099),
('20180313','B',4469),
('20180314','B',4050),
('20180314','A',1132),
('20180315','A',930),
('20180315','B',3387),
('20180316','B',3921),
('20180316','A',991),
('20180317','A',547),
('20180318','A',570),
('20180319','B',10198),
('20180319','A',1590),
('20180320','A',1142),
('20180320','B',4752),
('20180321','B',4231),
('20180321','A',938),
('20180322','B',3432),
('20180322','A',1207),
('20180323','B',3434),
('20180323','A',991),
('20180324','A',434),
('20180325','A',477),
('20180326','B',8069),
('20180326','A',1780),
('20180327','B',3915),
('20180327','A',1250),
('20180328','A',1127),
('20180328','B',3960),
('20180329','A',599),
('20180329','B',3598),
('20180330','A',473),
('20180331','B',4215),
('20180331','A',335),
('20180401','A',394),
('20180402','A',594),
('20180403','B',10151),
('20180403','A',1452),
('20180404','A',1554),
('20180404','B',4564),
('20180405','A',997),
('20180405','B',3316),
('20180406','B',3548),
('20180406','A',995),
('20180407','A',299),
('20180408','A',400),
('20180409','B',6898),
('20180409','A',968),
('20180410','A',1345),
('20180410','B',3262),
('20180411','A',963),
('20180411','B',4033),
('20180412','A',950),
('20180412','B',3715),
('20180413','A',927),
('20180413','B',3600),
('20180414','A',443),
('20180415','A',550),
('20180416','A',1461),
('20180416','B',9019),
('20180417','A',988),
('20180417','B',3953),
('20180418','A',971),
('20180418','B',3462),
('20180419','B',2798),
('20180419','A',858),
('20180420','A',1001),
('20180420','B',2721),
('20180421','A',538),
('20180422','A',758),
('20180423','B',7199),
('20180423','A',1336),
('20180424','A',1038),
('20180424','B',3699),
('20180425','B',3840),
('20180425','A',1075),
('20180426','B',3315),
('20180426','A',1299),
('20180427','A',984),
('20180427','B',3349),
('20180428','A',502),
('20180429','A',562),
('20180430','B',8348),
('20180430','A',1378),
('20180501','A',570),
('20180502','A',830),
('20180502','B',8068),
('20180503','B',3820),
('20180503','A',555),
('20180504','B',3213),
('20180504','A',532),
('20180505','A',229),
('20180506','A',312),
('20180507','B',6989),
('20180507','A',621),
('20180508','A',591),
('20180508','B',3698),
('20180509','B',2872),
('20180509','A',581),
('20180510','A',341),
('20180511','A',570),
('20180511','B',5688),
('20180512','A',205),
('20180513','A',345),
('20180514','B',7804),
('20180514','A',701),
('20180515','B',4047),
('20180515','A',559),
('20180516','A',717),
('20180516','B',3910),
('20180517','A',557),
('20180517','B',4444),
('20180518','B',3414),
('20180518','A',476),
('20180519','A',246),
('20180520','A',260),
('20180521','A',286),
('20180522','A',782),
('20180522','B',9567),
('20180523','A',648),
('20180523','B',4027),
('20180524','A',642),
('20180524','B',3552),
('20180525','A',640),
('20180525','B',3350),
('20180526','A',387),
('20180527','A',503),
('20180528','B',7787),
('20180528','A',903),
('20180529','A',855),
('20180529','B',3819),
('20180530','A',659),
('20180530','B',3669),
('20180531','A',590),
('20180531','B',3039),
('20180601','A',709),
('20180601','B',3693),
('20180602','A',477),
('20180603','A',615),
('20180604','B',8703),
('20180604','A',892),
('20180605','B',3463),
('20180605','A',875),
('20180606','A',719),
('20180606','B',3167),
('20180607','B',2717),
('20180607','A',729),
('20180608','B',2734),
('20180608','A',635),
('20180609','A',493),
('20180610','A',685),
('20180611','B',6991),
('20180611','A',912),
('20180612','A',1017),
('20180612','B',3447),
('20180613','B',3848),
('20180613','A',1033),
('20180614','B',3259),
('20180614','A',927),
('20180615','B',2924),
('20180615','A',753),
('20180616','A',488),
('20180617','A',626),
('20180618','A',1026),
('20180618','B',7989),
('20180619','A',996),
('20180619','B',3903),
('20180620','B',3524),
('20180620','A',801),
('20180621','A',718),
('20180621','B',3039),
('20180622','A',585),
('20180622','B',3277),
('20180623','A',380),
('20180624','A',491),
('20180625','B',8373),
('20180625','A',815),
('20180626','B',2929),
('20180626','A',700),
('20180627','B',3526),
('20180627','A',632),
('20180628','B',2607),
('20180628','A',650),
('20180629','A',541),
('20180629','B',3138),
('20180630','A',385),
('20180701','A',512),
('20180702','B',7550),
('20180702','A',944),
('20180703','A',742),
('20180703','B',3830),
('20180704','B',3312),
('20180704','A',698),
('20180705','B',3340),
('20180705','A',712),
('20180706','A',601),
('20180706','B',3133),
('20180707','A',400),
('20180708','A',548),
('20180709','B',6546),
('20180709','A',782),
('20180710','B',3673),
('20180710','A',756),
('20180711','B',3419),
('20180711','A',651),
('20180712','A',608),
('20180712','B',2963),
('20180713','A',483),
('20180713','B',2950),
('20180714','A',379),
('20180715','A',463),
('20180716','A',677),
('20180716','B',6382),
('20180717','A',926),
('20180717','B',3368),
('20180718','B',3120),
('20180718','A',646),
('20180719','B',3241),
('20180719','A',581),
('20180720','B',3127),
('20180720','A',475),
('20180721','A',381),
('20180722','A',548),
('20180723','B',7625),
('20180723','A',788),
('20180724','A',683),
('20180724','B',3455),
('20180725','B',3036),
('20180725','A',694),
('20180726','A',746),
('20180726','B',2961),
('20180727','A',746),
('20180727','B',2897),
('20180728','A',368),
('20180729','A',472),
('20180730','A',859),
('20180730','B',7206),
('20180731','A',770),
('20180731','B',3919),
('20180801','B',4023),
('20180801','A',775),
('20180802','B',3783),
('20180802','A',644),
('20180803','B',3137),
('20180803','A',608),
('20180804','A',368),
('20180805','A',534),
('20180806','B',7455),
('20180806','A',1058),
('20180807','A',788),
('20180807','B',3638),
('20180808','B',3443),
('20180808','A',812),
('20180809','A',715),
('20180809','B',2951),
('20180810','A',633),
('20180810','B',2965),
('20180811','A',383),
('20180812','A',518),
('20180813','A',975),
('20180813','B',7439),
('20180814','A',738),
('20180814','B',4020),
('20180815','B',4458),
('20180815','A',734),
('20180816','A',680),
('20180816','B',4117),
('20180817','A',594),
('20180817','B',3872),
('20180818','A',376),
('20180819','A',534),
('20180820','A',753),
('20180820','B',9110),
('20180821','B',4423),
('20180821','A',744),
('20180822','B',4099),
('20180822','A',701),
('20180823','A',743),
('20180823','B',3346),
('20180824','B',3651),
('20180824','A',574),
('20180825','A',457),
('20180826','A',532),
('20180827','A',876),
('20180827','B',9861),
('20180828','A',857),
('20180828','B',4898),
('20180829','A',694),
('20180829','B',4286),
('20180830','B',4329),
('20180830','A',722),
('20180831','B',4362),
('20180831','A',647),
('20180901','A',390),
('20180902','A',585),
('20180903','B',9879),
('20180903','A',760),
('20180904','B',5081),
('20180904','A',841),
('20180905','A',685),
('20180905','B',4193),
('20180906','B',3869),
('20180906','A',710),
('20180907','A',622),
('20180907','B',3948),
('20180908','A',411),
('20180909','A',564),
('20180910','A',842),
('20180910','B',9071),
('20180911','B',4639),
('20180911','A',861),
('20180912','B',4356),
('20180912','A',823),
('20180913','A',782),
('20180913','B',4043),
('20180914','B',4240),
('20180914','A',707),
('20180915','A',484),
('20180916','A',614),
('20180917','A',955),
('20180917','B',10613),
('20180918','B',5632),
('20180918','A',791),
('20180919','B',5071),
('20180919','A',818),
('20180920','B',4830),
('20180920','A',683),
('20180921','A',683),
('20180921','B',4861),
('20180922','A',510),
('20180923','A',687),
('20180924','A',878),
('20180924','B',14259),
('20180925','A',928),
('20180925','B',5691),
('20180926','B',5606),
('20180926','A',944),
('20180927','A',726),
('20180927','B',6643),
('20180928','B',5331),
('20180928','A',638),
('20180929','A',482),
('20180930','A',586),
('20181001','A',999),
('20181001','B',16015),
('20181002','B',8662),
('20181002','A',902),
('20181003','A',716),
('20181004','A',975),
('20181004','B',11283),
('20181005','B',5762),
('20181005','A',713),
('20181006','A',407),
('20181007','A',600),
('20181008','B',11962),
('20181008','A',852),
('20181009','B',6251),
('20181009','A',856),
('20181010','A',792),
('20181010','B',5885),
('20181011','B',5384),
('20181011','A',733),
('20181012','A',578),
('20181012','B',4865),
('20181013','A',366),
('20181014','A',535),
('20181015','B',11613),
('20181015','A',889),
('20181016','A',812),
('20181016','B',6316),
('20181017','B',5464),
('20181017','A',716),
('20181018','B',5233),
('20181018','A',834),
('20181019','A',620),
('20181019','B',5028),
('20181020','A',423),
('20181021','A',608),
('20181022','B',13754),
('20181022','A',898),
('20181023','B',6196),
('20181023','A',998),
('20181024','A',890),
('20181024','B',6134),
('20181025','A',790),
('20181025','B',6226),
('20181026','A',629),
('20181026','B',5252),
('20181027','A',503),
('20181028','A',751),
('20181029','A',1027),
('20181029','B',16638),
('20181030','A',938),
('20181030','B',6535),
('20181031','A',871),
('20181031','B',6883),
('20181101','A',617),
('20181102','A',706),
('20181102','B',11409),
('20181103','A',458),
('20181104','A',630),
('20181105','A',932),
('20181105','B',15471),
('20181106','B',7053),
('20181106','A',945),
('20181107','A',871),
('20181107','B',7156),
('20181108','B',5728),
('20181108','A',761),
('20181109','B',5979),
('20181109','A',670),
('20181110','A',499),
('20181111','A',632),
('20181112','B',17132),
('20181112','A',974),
('20181113','A',999),
('20181113','B',7288),
('20181114','A',803),
('20181114','B',8570),
('20181115','A',700),
('20181115','B',9413),
('20181116','B',9176),
('20181116','A',592),
('20181117','A',455),
('20181118','A',548),
('20181119','A',963),
('20181119','B',30339),
('20181120','A',737),
('20181120','B',13113),
('20181121','B',10610),
('20181121','A',818),
('20181122','A',790),
('20181122','B',8987),
('20181123','B',7874),
('20181123','A',975),
('20181124','A',636),
('20181125','A',817),
('20181126','B',25194),
('20181126','A',1187),
('20181127','B',10605),
('20181127','A',887),
('20181128','B',9855),
('20181128','A',774),
('20181129','B',8628),
('20181129','A',899),
('20181130','B',7596),
('20181130','A',619),
('20181201','A',377),
('20181202','A',693),
('20181203','A',1047),
('20181203','B',17614),
('20181204','A',826),
('20181204','B',7047),
('20181205','A',817),
('20181205','B',7284),
('20181206','B',6614),
('20181206','A',753),
('20181207','A',632),
('20181207','B',6008),
('20181208','A',446),
('20181209','A',634),
('20181210','B',14574),
('20181210','A',963),
('20181211','A',844),
('20181211','B',6474),
('20181212','A',717),
('20181212','B',6212),
('20181213','A',674),
('20181213','B',5400),
('20181214','A',643),
('20181214','B',5241),
('20181215','A',487),
('20181216','A',618),
('20181217','B',14153),
('20181217','A',933),
('20181218','A',773),
('20181218','B',8441),
('20181219','A',731),
('20181219','B',12776),
('20181220','A',664),
('20181220','B',14327),
('20181221','A',565),
('20181221','B',14371),
('20181222','A',396),
('20181223','A',400),
('20181224','A',423),
('20181225','A',339),
('20181226','A',493),
('20181227','A',1027),
('20181227','B',34180),
('20181228','A',832),
('20181228','B',12904),
('20181229','A',519),
('20181230','A',418),
('20181231','A',603),
('20181231','B',22649),
('20190101','A',356),
('20190102','B',12791),
('20190102','A',985),
('20190103','B',9903),
('20190103','A',936),
('20190104','A',757),
('20190104','B',5942),
('20190105','A',586),
('20190106','A',630),
('20190107','B',17012),
('20190107','A',1139),
('20190108','B',8852),
('20190108','A',878),
('20190109','A',778),
('20190109','B',6661),
('20190110','A',727),
('20190110','B',5521),
('20190111','A',655),
('20190111','B',4830),
('20190112','A',496),
('20190113','A',648),
('20190114','B',14145),
('20190114','A',1042),
('20190115','A',944),
('20190115','B',6392),
('20190116','A',798),
('20190116','B',5713),
('20190117','A',747),
('20190117','B',5473),
('20190118','B',5868),
('20190118','A',618),
('20190119','A',442),
('20190120','A',615),
('20190121','A',847),
('20190121','B',11963),
('20190122','A',761),
('20190122','B',6056),
('20190123','B',6332),
('20190123','A',611),
('20190124','B',5112),
('20190124','A',697),
('20190125','A',595),
('20190125','B',5019),
('20190126','A',488),
('20190127','A',656),
('20190128','A',867),
('20190128','B',11955),
('20190129','A',839),
('20190129','B',5330),
('20190130','B',5014),
('20190130','A',754),
('20190131','A',991),
('20190131','B',8845),
('20190201','A',1159),
('20190201','B',14213),
('20190202','A',736),
('20190203','A',857),
('20190204','B',24529),
('20190204','A',1171),
('20190205','B',10737),
('20190205','A',1187),
('20190206','B',9893),
('20190206','A',1046),
('20190207','A',844),
('20190207','B',12802),
('20190208','B',8970),
('20190208','A',809),
('20190209','A',639),
('20190210','A',838),
('20190211','A',996),
('20190211','B',21521),
('20190212','A',1091),
('20190212','B',9297),
('20190213','A',971),
('20190213','B',8433),
('20190214','A',795),
('20190214','B',6720),
('20190215','A',739),
('20190215','B',6067),
('20190216','A',442),
('20190217','A',709),
('20190218','B',14407),
('20190218','A',1052),
('20190219','A',1042),
('20190219','B',6607),
('20190220','A',955),
('20190220','B',5666),
('20190221','B',4931),
('20190221','A',925),
('20190222','A',823),
('20190222','B',3906),
('20190223','A',664),
('20190224','A',656),
('20190225','A',951),
('20190225','B',9425),
('20190226','B',4256),
('20190226','A',856),
('20190227','A',837),
('20190227','B',3868),
('20190228','B',3648),
('20190228','A',918),
('20190301','B',3651),
('20190301','A',759),
('20190302','A',601),
('20190303','A',736),
('20190304','B',8331),
('20190304','A',996),
('20190305','A',943),
('20190305','B',4019),
('20190306','B',3457),
('20190306','A',871),
('20190307','A',943),
('20190307','B',2909),
('20190308','A',776),
('20190308','B',2657),
('20190309','A',585),
('20190310','A',851),
('20190311','A',1025),
('20190311','B',8094),
('20190312','B',3480),
('20190312','A',993),
('20190313','B',3241),
('20190313','A',929),
('20190314','B',3301),
('20190314','A',828),
('20190315','A',743),
('20190315','B',2921),
('20190316','A',608),
('20190317','A',765),
('20190318','B',7810),
('20190318','A',934),
('20190319','B',4205),
('20190319','A',909),
('20190320','B',3258),
('20190320','A',890),
('20190321','A',780),
('20190321','B',2698),
('20190322','B',2487),
('20190322','A',806),
('20190323','A',681),
('20190324','A',804),
('20190325','B',6218),
('20190325','A',1380),
('20190326','B',3430),
('20190326','A',1177),
('20190327','A',1064),
('20190327','B',3170),
('20190328','B',2753),
('20190328','A',965),
('20190329','A',870),
('20190329','B',2521),
('20190330','A',602),
('20190330','B',1394),
('20190331','A',838),
('20190331','B',1859),
('20190401','A',1058),
('20190401','B',2165),
('20190402','A',924),
('20190402','B',3220),
('20190403','B',3217),
('20190403','A',963),
('20190404','A',927),
('20190404','B',2534),
('20190405','A',861),
('20190405','B',2474),
('20190406','A',501),
('20190407','A',646),
('20190408','A',1007),
('20190408','B',4784),
('20190409','A',925),
('20190409','B',2391),
('20190410','A',983),
('20190410','B',2718),
('20190411','A',867),
('20190411','B',2426),
('20190412','A',784),
('20190412','B',2249),
('20190413','A',582),
('20190414','A',864),
('20190415','A',1034),
('20190415','B',6040),
('20190416','B',2841),
('20190416','A',848),
('20190417','B',2697),
('20190417','A',785),
('20190418','B',2455),
('20190418','A',647),
('20190419','A',589),
('20190420','A',433),
('20190421','A',454),
('20190422','A',662),
('20190423','A',1098),
('20190423','B',7610),
('20190424','B',2985),
('20190424','A',931),
('20190425','B',2414),
('20190425','A',906),
('20190426','A',799),
('20190426','B',2481),
('20190427','A',672),
('20190428','A',890),
('20190429','B',7021),
('20190429','A',1138),
('20190430','B',3282),
('20190430','A',889),
('20190501','A',719),
('20190502','A',991),
('20190502','B',4506),
('20190503','A',715),
('20190503','B',2913),
('20190504','A',586),
('20190505','A',738),
('20190506','A',1087),
('20190506','B',6206),
('20190507','A',857),
('20190507','B',2755),
('20190508','B',2513),
('20190508','A',910),
('20190509','A',893),
('20190509','B',2348),
('20190510','B',2228),
('20190510','A',718),
('20190511','A',507),
('20190512','A',713),
('20190513','A',1028),
('20190513','B',4930),
('20190514','B',2426),
('20190514','A',872),
('20190515','B',2460),
('20190515','A',1066),
('20190516','B',2276),
('20190516','A',869),
('20190517','A',814),
('20190517','B',2654),
('20190518','A',467),
('20190519','A',686),
('20190520','B',5452),
('20190520','A',982),
('20190521','B',3112),
('20190521','A',1009),
('20190522','A',1018),
('20190522','B',2773),
('20190523','B',2196),
('20190523','A',828),
('20190524','A',686),
('20190524','B',2045),
('20190525','A',508),
('20190526','A',694),
('20190527','B',4762),
('20190527','A',1090),
('20190528','B',2590),
('20190528','A',990),
('20190529','B',2215),
('20190529','A',800),
('20190530','A',767),
('20190531','B',3381),
('20190531','A',1613),
('20190601','A',493),
('20190602','A',614),
('20190603','B',4479),
('20190603','A',996),
('20190604','B',2507),
('20190604','A',787),
('20190605','B',2178),
('20190605','A',839),
('20190606','B',2113),
('20190606','A',762),
('20190607','A',603),
('20190607','B',2254),
('20190608','A',478),
('20190609','A',459),
('20190610','A',596),
('20190611','A',971),
('20190611','B',5556),
('20190612','B',2558),
('20190612','A',830),
('20190613','A',785),
('20190613','B',2074),
('20190614','A',620),
('20190614','B',2130),
('20190615','A',439),
('20190616','A',656),
('20190617','A',882),
('20190617','B',4857),
('20190618','B',2152),
('20190618','A',804),
('20190619','A',700),
('20190619','B',2128),
('20190620','A',660),
('20190621','B',4064),
('20190621','A',731),
('20190622','A',402),
('20190623','A',460),
('20190624','B',4331),
('20190624','A',1042),
('20190625','A',871),
('20190625','B',2425),
('20190626','B',2583),
('20190626','A',732),
('20190627','B',2288),
('20190627','A',621),
('20190628','A',469),
('20190628','B',2510),
('20190629','A',371),
('20190630','A',503),
('20190701','B',6406),
('20190701','A',785),
('20190702','B',2750),
('20190702','A',769),
('20190703','B',2598),
('20190703','A',627),
('20190704','A',652),
('20190704','B',2138),
('20190705','B',2068),
('20190705','A',545),
('20190706','A',412),
('20190707','A',596),
('20190708','B',4954),
('20190708','A',842),
('20190709','A',729),
('20190709','B',2469),
('20190710','B',2121),
('20190710','A',674),
('20190711','A',635),
('20190711','B',1933),
('20190712','A',530),
('20190712','B',2087),
('20190713','A',437),
('20190714','A',582),
('20190715','B',5138),
('20190715','A',783),
('20190716','A',716),
('20190716','B',2327),
('20190717','A',652),
('20190717','B',2240),
('20190718','B',1867),
('20190718','A',614),
('20190719','A',529),
('20190719','B',2108),
('20190720','A',351),
('20190721','A',473),
('20190722','A',698),
('20190722','B',4390),
('20190723','B',2351),
('20190723','A',663),
('20190724','A',617),
('20190724','B',2247),
('20190725','B',1937),
('20190725','A',601),
('20190726','B',1800),
('20190726','A',538),
('20190727','A',374),
('20190728','A',547),
('20190729','A',831),
('20190729','B',5000),
('20190730','B',2888),
('20190730','A',728),
('20190731','B',2487),
('20190731','A',754),
('20190801','B',2517),
('20190801','A',777),
('20190802','A',641),
('20190802','B',2492),
('20190803','A',436),
('20190804','A',500),
('20190805','B',5189),
('20190805','A',839),
('20190806','A',738),
('20190806','B',2613),
('20190807','A',724),
('20190807','B',2573),
('20190808','A',662),
('20190808','B',2274),
('20190809','A',609),
('20190809','B',2079),
('20190810','A',421),
('20190811','A',472),
('20190812','A',919),
('20190812','B',4963),
('20190813','B',2705),
('20190813','A',761),
('20190814','B',3001),
('20190814','A',688),
('20190815','B',2740),
('20190815','A',697),
('20190816','A',647),
('20190816','B',3032),
('20190817','A',393),
('20190818','A',522),
('20190819','A',878),
('20190819','B',6443),
('20190820','B',3248),
('20190820','A',785),
('20190821','A',677),
('20190821','B',3108),
('20190822','A',670),
('20190822','B',2594),
('20190823','A',571),
('20190823','B',2263),
('20190824','A',378),
('20190825','A',529),
('20190826','A',786),
('20190826','B',6943),
('20190827','A',786),
('20190827','B',2774),
('20190828','B',2783),
('20190828','A',737),
('20190829','A',752),
('20190829','B',2630),
('20190830','B',2467),
('20190830','A',626),
('20190831','A',404),
('20190901','A',560),
('20190902','B',7047),
('20190902','A',814),
('20190903','A',839),
('20190903','B',3460),
('20190904','A',755),
('20190904','B',3012),
('20190905','A',686),
('20190905','B',2510),
('20190906','A',611),
('20190906','B',3100),
('20190907','A',489),
('20190908','A',687),
('20190909','A',917),
('20190909','B',6728),
('20190910','B',3172),
('20190910','A',741),
('20190911','A',708),
('20190911','B',2808),
('20190912','B',2722),
('20190912','A',632),
('20190913','A',656),
('20190913','B',2706),
('20190914','A',519),
('20190915','A',693),
('20190916','A',951),
('20190916','B',5944),
('20190917','B',3443),
('20190917','A',871),
('20190918','A',766),
('20190918','B',3605),
('20190919','B',3057),
('20190919','A',753),
('20190920','A',658),
('20190920','B',2939),
('20190921','A',510),
('20190922','A',622),
('20190923','B',7088),
('20190923','A',996),
('20190924','B',4198),
('20190924','A',825),
('20190925','B',3994),
('20190925','A',832),
('20190926','A',783),
('20190926','B',3903),
('20190927','A',675),
('20190927','B',4489),
('20190928','A',418),
('20190929','A',621),
('20190930','A',778),
('20190930','B',13546),
('20191001','A',783),
('20191001','B',5868),
('20191002','B',4197),
('20191002','A',534),
('20191003','A',503),
('20191004','A',549),
('20191004','B',7043),
('20191005','A',372),
('20191006','A',517),
('20191007','B',8919),
('20191007','A',763),
('20191008','A',630),
('20191008','B',4281),
('20191009','B',3948),
('20191009','A',630),
('20191010','B',3749),
('20191010','A',534),
('20191011','A',536),
('20191011','B',3643),
('20191012','A',333),
('20191013','A',448),
('20191014','B',8146),
('20191014','A',775),
('20191015','A',679),
('20191015','B',4562),
('20191016','B',5346),
('20191016','A',625),
('20191017','B',5057),
('20191017','A',610),
('20191018','B',5043),
('20191018','A',624),
('20191019','A',455),
('20191020','A',585),
('20191021','A',734),
('20191021','B',13190),
('20191022','A',733),
('20191022','B',5736),
('20191023','A',653),
('20191023','B',5063),
('20191024','A',686),
('20191024','B',4647),
('20191025','B',4169),
('20191025','A',523),
('20191026','A',410),
('20191027','A',601),
('20191028','A',745),
('20191028','B',12538),
('20191029','B',5480),
('20191029','A',821),
('20191030','A',592),
('20191030','B',5827),
('20191031','A',665),
('20191031','B',5857),
('20191101','A',598),
('20191102','A',438),
('20191103','A',574),
('20191104','B',21737),
('20191104','A',950),
('20191105','A',735),
('20191105','B',6615),
('20191106','A',609),
('20191106','B',5678),
('20191107','B',4233),
('20191107','A',603),
('20191108','A',601),
('20191108','B',6038),
('20191109','A',436),
('20191110','A',542),
('20191111','B',14672),
('20191111','A',810),
('20191112','B',6336),
('20191112','A',594),
('20191113','B',6718),
('20191113','A',554),
('20191114','B',6702),
('20191114','A',561),
('20191115','A',502),
('20191115','B',7052),
('20191116','A',376),
('20191117','A',579),
('20191118','B',22180),
('20191118','A',780),
('20191119','B',10500),
('20191119','A',607),
('20191120','B',9243),
('20191120','A',601),
('20191121','B',8169),
('20191121','A',540),
('20191122','A',586),
('20191122','B',7442),
('20191123','A',477),
('20191124','A',645),
('20191125','B',17973),
('20191125','A',977),
('20191126','B',8680),
('20191126','A',648),
('20191127','A',752),
('20191127','B',7901),
('20191128','A',720),
('20191128','B',6400),
('20191129','A',1124),
('20191129','B',6172),
('20191130','A',597),
('20191130','B',4672),
('20191201','A',842),
('20191202','A',1378),
('20191202','B',10628),
('20191203','B',7624),
('20191203','A',1162),
('20191204','A',775),
('20191204','B',6282),
('20191205','A',673),
('20191205','B',5376),
('20191206','B',5068),
('20191206','A',574),
('20191207','A',414),
('20191208','A',541),
('20191209','B',13318),
('20191209','A',890),
('20191210','B',6485),
('20191210','A',647),
('20191211','B',5857),
('20191211','A',672),
('20191212','A',621),
('20191212','B',5410),
('20191213','A',668),
('20191213','B',4803),
('20191214','A',615),
('20191215','A',694),
('20191216','B',13832),
('20191216','A',891),
('20191217','B',6758),
('20191217','A',730),
('20191218','A',583),
('20191218','B',6607),
('20191219','B',5614),
('20191219','A',500),
('20191220','A',484),
('20191220','B',5442),
('20191221','A',362),
('20191222','A',361),
('20191223','B',11991),
('20191223','A',445),
('20191224','A',215),
('20191225','A',306),
('20191226','A',352),
('20191227','B',11963),
('20191227','A',662),
('20191228','A',397),
('20191229','A',437),
('20191230','A',644),
('20191230','B',17733),
('20191231','B',7225),
('20191231','A',316);

WITH PREP AS
(
SELECT
	 ORDER_TYPE
	,ORDERS
	,TO_DATE(ORDER_DATE_ID, 'YYYYMMDD') AS ORDER_DATE
FROM
	TMP
)
SELECT
	 P.ID
	,ROUND(P.Y) AS ORDERS
	,P.D::DATE AS D
FROM
	 PREP
    ,TABLE(PROPHETIZE_DAILY(ORDER_TYPE, ORDERS::FLOAT, ORDER_DATE, 90) OVER (PARTITION BY ORDER_TYPE)) AS P;